z="777812a0090470810a00a007024040050130531000000000bbbe70e32f08b0b50e02d04c0780900a0390880111000000ffffb3f95f8af7fb7f67f39f3bf1d84d49f5de0333000000ffffeafdcfcdfcfdcfbbfadfaefafebfacfbff9888000000".match(/.../g).map((f=>+("0xff"+f[0]+f[0]+f[1]+f[1]+f[2]+f[2]))),A=()=>{m=[],b=[],e=r=d=N=c=u=E=S=o=v=C=B=P=g=h=i=p=0,J(0),K(0)},F=f=>((f&=16383)>16127?16144==(f&=16159)&&(f=16128):f>12287?f-=4096:f>8191&&(0==w?f&=14335:1==w&&(f&=15359)),f),G=f=>m[F(f)],H=(f,a)=>{m[F(f)]=a},J=f=>{s=f>>7&1,D=f>>5&1,I=f>>4&1,k=f>>3&1,l=f>>2&1,S=3&f},K=f=>{n=f>>4&1,q=f>>3&1},L=()=>(f=cpu_mem[8194]=0+(g<<5)+(h<<6)+(i<<7),p=0,i=0,f),O=f=>{M=f},Q=()=>b[M],R=f=>{b[M]=f,M++,M%=256},T=f=>{0==p?(v=f>>3,C=7&f):(o=f>>3,E=7&f),p^=1},V=f=>{0==p?(j=f<<8,E=f>>4&3,S=f>>2&3,o=(3&f)<<3):(j+=f,d=E,c=o+=f>>5,u=v=31&f,N=S),p^=1},W=f=>{H(j,f),j+=l?32:1},X=()=>(j<=16128?(f=U,U=G(j)):f=G(j),j+=1===l?32:1,f),Y=f=>{for(var a=M;a<256;a++)b[a]=cpu_mem[256*f+a];for(a=0;a<513;a++)CPU.tick()},Z=a=>{var e,r,b,d,N,c;for(t=[],r=~~(a/8),e=0;e<64;e++)for(d=G((b=8192+2048*(r>29)+1024*(e>31))+960+8*(r%30>>2)+(e%32>>2))>>4*(r%30>>1&1)+2*(e%32>>1&1)&3,N=[z[m[16128]],z[m[16128+4*d+1]],z[m[16128+4*d+2]],z[m[16128+4*d+3]]],a%=8,x=0;x<8;x++)f=4096*I+16*G(b+r%30*32+e%32)+a,(c=2*(G(f+8)>>7-x&1)+(G(f)>>7-x&1))&&(t[8*e+x]=N[c]),NES.vramBuffer32[512*(8*r+a)+(8*e+x)]=N[c]},$=e=>{var r,d,x,N,c,u,E;for(x=[],r=0;r<64;r++)if(e>=b[4*r]&&e<b[4*r]+(D?16:8)){if(8==x.length){g=1;break}x.push(r)}for(d=0;d<256;d++)for(q&&(NES.frameBuffer32[256*e+d]=NES.vramBuffer32[(e+P)%480*512+(d+B)%512]),r=x.length-1;r>=0;r--)d>=b[4*x[r]+3]&&d<b[4*x[r]+3]+8&&(c=3&b[4*x[r]+2],u=[,z[m[16144+4*c+1]],z[m[16144+4*c+2]],z[m[16144+4*c+3]]],f=4*x[r],a=b[f],N=4096*(D?1&b[f+1]:k)+16*(b[f+1]&255-D)+(128&b[f+2]?7-e+a+8*((e<a+8&&D)+D):8+e-a-8*(e<a+8)),f=d-b[4*x[r]+3],a=64&b[4*x[r]+2]?f:7-f,(E=2*(G(N+8)>>a&1)+(G(N)>>a&1))&&(!n||32&b[4*x[r]+2]&&t[d+B]&&q||(NES.frameBuffer32[256*e+d]=u[E]),0===x[r]&&!h&&E&&t[d]&&n&&q&&(h=1)))},_=()=>{++r>341&&(r=0,e++,u=v,N=(2&N)+(1&S),e<241?(Z((e+P)%480-1),Z((e+P)%480-1+240),$(e-1),B=256*(1&N)+8*u+C):241==e?(i=1,CPU.request_interrupt(CPU.NMI),NES.frameData.data.set(NES.frameBuffer8),NES.frameCtx.putImageData(NES.frameData,0,0)):261==e?g=h=i=0:262==e&&(e=0,y=1,P=240*((N=(1&N)+(2&S))>>1)+8*(c=o)+(d=E)))}